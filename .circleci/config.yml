version: 2.1

jobs:
    build:
        docker:
            - image: cibuilds/hugo:latest
        working_directory: ~/hugo
        environment:
            - COMMIT_AUTHOR_EMAIL: "aetreon.makeo@gmail.com"
            - HUGO_BUILD_DIR: ~/hugo/public
        steps:
            - checkout
            - run: apk update && apk add git
            - run: git checkout master || git checkout --orphan gh-pages
            - run: git reset --hard
            - run: hugo -t meghna-hugo
            - run: git config user.name "Circle CI"
            - run: git config user.email "$COMMIT_AUTHOR_EMAIL"
            - run: git add -A .
            - run: git commit -m "Deploy to GitHub Pages"
            - run: git push -f
              #- run: git submodule sync && git submodule update --init
              #- run:
              # name: Prepare shell commands
              # command: chmod +x .circleci/deploy.sh
              #- deploy:
              #  name: Deploy to Github Pages
              #  command: ./.circleci/deploy.sh
